---
title: "synology DS216j DSM 재설치 기록"
excerpt: "2016년 7월쯤 설정한 NAS를 재설치 한 기록"
categories:
  - nas
tags:
  - synology
last_modified_at: 2018-07-02T12:00:00-05:00
---


DSM을 재설치 하기 전에는 2TB 하드디스크 두 개를 사용하여 RAID1을 구성 하였었고, 따라서 총 용량 2TB로 사용 하였었다. DSM을 재설치 하게 된 이유는 기존 RAID1 설정을 RAID0로 바꿔서 총 용량 4TB로 사용하고 싶었기 때문이다. 그러나 저장소 관리자에서 RAID1을 RAID0로 쉽게 바꾸는 방법은 없는 것으로 보였다. 따라서 기존 볼륨을 지우고 새로운 볼륨을 만들면서 저장소를 RAID0로 바꾸는 방법을 시도하였다. 그러나 기존 볼륨을 제거하려면 그림 1과 같은 창이 뜨면서 여러 네트워크 서비스를 중단해야 하는데 그런 것을 일일이 하기가 너무 귀찮았다. 

| ![](/assets/images/2018-07-02/fig01_previous_network_service.png) |
| :----------------------------------------------------------: |
|  **그림 1. 저장소 관리자 볼륨 제거 버튼을 누를 때 뜨는 창**  |



그래서 약 2년만에 DSM을 새로 설치해 보고 각종 설정들 역시 다시 해보자는 마음으로 초기화를 하게 되었다. 초기화를 하기 전에 기존에 설치 했었던 패키지는 그림 2와 같다.

| ![](/assets/images/2018-07-02/fig02_previous_installed_packages.png) |
| :----------------------------------------------------------: |
|  **그림 2. 기존에 설치했었던 패키지**  |



## 1. DSM을 재설치하기 위한 설정

운영체제를 다시 설치하기 위한 설정은 [Synology DiskStation Manager 페이지](https://www.synology.com/ko-kr/knowledgebase/DSM/tutorial)에서 검색하였다.

진행과정에 대해 요약하면 기기 후면에 reset 버튼이 있는데, 이 reset 버튼을 약 4초간 누르고 삐 소리가 나면 또 다시 4초간 누르고 있으라는 말이다. 이렇게 하면 전면 LED 중 하나가 주황색이 되면서 운영체제를 새로 설치하는 모드로 진행된다. 막상 해보면 진짜 그렇게 되는지 애매하다. 그리고 화면을 보면서 하는 게 아니기 때문에 이 과정이 직관적이지 않다. 공유기에 같이 물린 NAS를 화면에 띄우기 위해서는 기존에 하던 방법인 웹브라우저에서 `find.synology.com`을 치면 된다. 그런 후 안내에 따라 아래 그림과 같은 순서로 운영체제 재설치를 진행한다.

| ![](/assets/images/2018-07-02/fig03.png) |
| :----------------------------------------------------------: |
|  **관리자 계정 생성**  |

| ![](/assets/images/2018-07-02/fig04.png) |
| :----------------------------------------------------------: |
|  **DSM 업데이트 및 유지 보수**  |

| ![](/assets/images/2018-07-02/fig05.png) |
| :----------------------------------------------------------: |
|  **QuickConnect 설정: 이 단계 건너뛰기를 선택 (기존처럼 DDNS를 사용)**  |

| ![](/assets/images/2018-07-02/fig06.png) |
| :----------------------------------------------------------: |
|  **권장 패키지 설치: 이 단계 건너뛰기 선택 (수동으로 필요한 것만 설치)**  |

| ![](/assets/images/2018-07-02/fig07.png) |
| :----------------------------------------------------------: |
|  **설정 완료**  |

처음 진입하는 화면은 아래와 같다. 

| ![](/assets/images/2018-07-02/fig08.png) |
| :----------------------------------------------------------: |
|  **설정 완료 후 DSM 바탕화면 처음 진입 시 화면**  |

위 그림처럼 설정 완료 후 처음 바탕화면의 우측 시스템 상태를 보면 마치 기존 상태같이 볼륨1의 디스크 공간이 부족하다고 나온다. 그래서 저장소 관리자에서 확인을 해 보았더니 기존 볼륨이 그대로 남아 있었다. DSM은 윈도우처럼 운영체제를 새로 설치하는 과정에서 기존 HDD의 데이터 정보를 날려버리는 것이 아닌 것으로 보인다. 그러나 운영체제 재설치에 의해 여러 네트워크 서비스가 종료된 셈이니 저장소 관리자에서 볼륨 제거를 할 수 있게 되었다. 따라서 볼륨 제거를 시도하였다.



## 2. 기존 스토리지 풀 및 볼륨 제거

기존 볼륨을 제거하기 위해 **`저장소 관리자`**를 실행하면 아래 그림과 같이 개요에서 기존 설정이 그대로 남아 있음을 확인할 수 있다. 

![](/assets/images/2018-07-02/fig09.png)



**`볼륨탭에서 제거를 선택`**하면 아래 그림과 같이 기존 네트워크 서비스가 해제 되었음을 알 수 있다.

![](/assets/images/2018-07-02/fig10.png)



그리고 **`제거를 선택`**하면 아래 그림과 같이 경고메세지가 뜬다.

![](/assets/images/2018-07-02/fig11.png)



제거하고 나면 아래와 같이 시스템에 볼륨이 없다고 뜬다.

![](/assets/images/2018-07-02/fig12.png)



그 후 볼륨 생성 과정을 거치려고 했다. 그러나 아래 그림과 같이 기존 스토리지 풀이 RAID1으로 잡혀 있으니까 현재 목적인 RAID0로 바꾸는 메뉴가 비활성화 되어서 바꿀 수가 없었다.

![](/assets/images/2018-07-02/fig13.png)



따라서 아래와 같이 기존 스토리지 풀도 삭제하였다.

![](/assets/images/2018-07-02/fig14.png)

![](/assets/images/2018-07-02/fig15.png)

![](/assets/images/2018-07-02/fig16.png)



## 3. 새로운 볼륨 생성

이제 다시 볼륨 생성 과정을 거친다. 아래 그림과 같이 **사용자 지정 > 새로운 스토리지 풀 생성 > 보다 우수한 성능 > RAID0 선택 > 디스크 선택 > 디스크 검사 수행 > 볼륨 용량 할당 > 설정 확인** 을 차례로 선택해 준다.

![](/assets/images/2018-07-02/fig17.png)

![](/assets/images/2018-07-02/fig18.png)

![](/assets/images/2018-07-02/fig19.png)

![](/assets/images/2018-07-02/fig20.png)

![](/assets/images/2018-07-02/fig21.png)

![](/assets/images/2018-07-02/fig22.png)

![](/assets/images/2018-07-02/fig23.png)

![](/assets/images/2018-07-02/fig24.png)

![](/assets/images/2018-07-02/fig25.png)

![](/assets/images/2018-07-02/fig26.png)

**중간과정에서 디스크 검사 수행을 선택했기 때문에 새로운 볼륨을 생성하는데 약 8시간 이상 소요된다.**



## 4. 현재 상황 살펴보기

### 4-1. 접속 도메인 관련

외부에서 공유기에 물린 NAS로 외부에서 접속하려면 QuickConnect 또는 DDNS 방법이 있다. 기존 설정에서는 QuickConnect는 사용하지 않고 DDNS를 사용하여 `***********.synology.me` 라는 주소를 synology 사이트에서 등록하여 사용했던 기억이 있다.

그런데 운영체제가 새로 설치되어 옛날 도메인이던 `***********.synology.me` 가 안될 줄 알았는데 막상 시도해보니 그냥 된다. 즉, 이전 설정이 그대로 남아 있는 것으로 보인다. 이러한 이전설정이 synology 사이트에 남아있어서 인지 또는 NAS에 그대로 남아있어서 인지는 아직 잘 모르겠다. 다만 이것에 관련된 설정은 **제어판 > 외부 액세스 > DDNS** 인데 확인해 보니 아무 설정도 안되어 있다. 그런데 같은 공유기 내에 있는 집 컴퓨터에서는 이전 도메인이 먹히는 걸로 보아 진짜 외부 컴퓨터에서도 접속이 가능한지는 확인해 봐야 한다. 우선 이것에 대한 자세한 것은 넘어가기로 한다.

### 4-2. 공유 폴더

File Station을 실행해 보면 공유 폴더가 하나도 없음을 알 수 있다. `music`, `video`, `photo` 등의 공유폴더는
수동으로 생성하기 보다는 관련 패키지를 설치하면 저절로 생성되었던 것으로 기억하기 때문에 패키지를 설치하고 저절로 생성되는지 확인하자.

### 4-3. 패키지 센터

운영체제를 재설치하고 처음 패키지 센터를 키면 약관 동의 및 개인정보에 대한 동의가 나온다. 동의 하였다. 처음 설치되어 있는 패키지는 아래와 같다.

![](/assets/images/2018-07-02/fig27.png)

### 4-4. 운영체제 버전

`DS216j`를 처음사서 설정을 할 때 인터넷에서 얻은 여러 정보를 참고하였는데 패키지 설치할 때 그 정보와
다르게 패키지 목록이 잘 안 뜨는 경우가 있었다. 그 원인이 운영체제 버전이 낮아서 그랬던 것 같다. 따라서 운영체제 버전을 확인해 보았다. 아래 그림과 같이 설치 당시 업데이트 목록이 있었다. **곧바로 업데이트를 해 주자.**

![](/assets/images/2018-07-02/fig28.png)



## 5. Antivirus Essential

운영체제 업데이트가 완료되고 **`패키지 센터 > 모든 패키지 > 보안 > Antivirus Essential`** 을 설치했다. 2017년 중반에 랜섬웨어에 걸린 적이 있어서 바이러스에 대한 모든 대비를 하는 게 좋다고 생각했다.



## 6. Audio Station, Video Station, Photo Station, Download Station

Audio, Video, Photo Station을 설치하면 각각 music, video, photo 공유폴더가 자동으로 생성된다. **`패키지 센터 > 모든 패키지 > 멀티미디어 > 각 Station`** 을 설치한다.  Photo station 설치 시 PHP 7.0이 같이 설치된다.

설치 완료 후, 관리자 계정으로 아이패드에서 DSFile앱을 이용해서 접속을 해보면 music, photo, video 공유 폴더를 확인할 수 있다. DSFile앱의 오프라인 파일 중 아무거나 공유폴더에 업로드해보면 업로드가 되는 것을 확인 할 수 있다.

Download Station은 DSGet앱을 사용하거나 PC에서 접속하여 torrent를 다운 받을 수 있다. 생산성 카테고리에 있으니 설치하자.



## 7. 삼바(Samba) 설정

NAS의 공유폴더를 집컴퓨터에서 쉽게 접근하기 위한 삼바 설정 역시 이전 설정이 그대로 남아 있는 것 같다. 관련 설정은 아래와 같이 **`제어판 > 파일 서비스 > SMB 서비스 활성화`** 인데 원래 제일 처음 NAS를 사서 설정할 때는 활성화가 안되어 있는데 이전 설정이 그대로 남아 있는 것 같다. 더 자세한 사항은 Samba 관련 설정을 참고하자.

![](/assets/images/2018-07-02/fig29.png)


## 8. 읽기 권한만 가진 계정 추가

아래 그림과 같이 **`제어판 > 사용자 > 생성 > 사용자 정보 입력 > 그룹 선택 (그대로 둔다) > 공유폴더 권한 할당에서 읽기 전용 선택 > 사용량 할당 설정 (그대로 둔다) > 이후로 아래 그림과 같이 쭉 진행`**

![](/assets/images/2018-07-02/fig30.png)

![](/assets/images/2018-07-02/fig31.png)

![](/assets/images/2018-07-02/fig32.png)

![](/assets/images/2018-07-02/fig33.png)

![](/assets/images/2018-07-02/fig34.png)

![](/assets/images/2018-07-02/fig35.png)

![](/assets/images/2018-07-02/fig36.png)



## 9. 애플TV 인퓨즈 플레이어에서 Video 폴더 공유하기

계정을 새로 만들었기 때문에 애플TV 인퓨즈 설정에서 **`공유 > 공유 가능 리스트에서 NAS이름 선택 > 안전을 위해 id 및 패스워드를 읽기만 가능한 계정으로 설정하면서 프로토콜은 SMB를 선택 > video 폴더를 공유 폴더로 설정`** 해주면 기존과 같이 그대로 video 폴더를 공유 할 수 있다.



## 10. 아이패드 nPlayer에서 Video 폴더 공유하기

**`nPlayer > 네트워크 > 네트워크 검색 …`** 을 하면 SMB가 검색되고 192.168.0.*** 라는 내부 네트워크가 검색된다. 이것으로 계정, 비밀번호를 입력하고 설정하면 그대로 Video 폴더의 파일을 볼 수 있다. 그런데 여기서 기존에 사용하던 FTP (집 공유기가 아닌 외부 네트워크에서 스트리밍 하기위해)로 설정하려면 DDNS를 써야 하는데 이게 뭔가 잘 안 된다. 역시 DDNS를 재설정 해주지 않아서 일까?

위 FTP 문제를 나중에 성공했는데 **`제어판 > 파일 서비스 > FTP 탭 > FTP 서비스 활성화 (암호화 없음)`** 으로 해야 된다. 여기서 암호화 서비스(FTPS) 활성화를 하면 nPlayer에서 이름과 패스워드를 입력하라는 창이 뜨는데 무슨 의미인지 모르겠다. 어쨌든 그냥 약간 위험하게 써 보겠다.



## 11. DDNS 재설정

역시 운영체제를 재설치하고 나면 **`외부 액세스 > DDNS 목록`** 에 아무것도 설정이 안되어 있다. 아래와 같이 synology 사이트를 이용해서 DDNS를 기존과 같이 활성화 하였고 상태가 정상임을 확인하였다.

![](/assets/images/2018-07-02/fig37.png)

![](/assets/images/2018-07-02/fig38.png)





(끝)